{% extends "base.html" %}

{% block title %}SCOSS - Results{% endblock %}

{% block content %}
    <div class="row">
      <div class="col-12">
        <span>If you have any problem with the result, please email to {{author_email}}</span>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Results</h3>
            <!-- <div class="card-tools">
              <button class="btn btn-default" id="export" title="Save as CSV"><i class="fas fa-download"></i></button>
            </div> -->
          </div>
          <!-- /.card-header -->
          <div class="card-body table-responsive p-0">
            <table id="resultTable" class="display">
              <thead>
                <tr>
                      <th>Problem</th>
                      {%for head in heads%}
                      <th>{{head}} <i class="fa fa-sort"></i></th>
                      {%endfor%}
                  </tr>
              </thead>
              <tbody>
                
              </tbody>  
            </table>
          </div>
          <!-- /.card-body -->
        </div>
      </div>
    </div>
{% endblock %}

{% block js%}
<script>
   var dataUrl = '/api/contests/{{contest_id}}/results/dataTable'
   metrics = {{heads|tojson}}
   var columns = []
   columns.push({"data": 'problem_name'})
   metrics.forEach(function(value) {
      if (value=='source1' || value=='source2') {
        columns.push({"data": value})
      } else {
        columns.push({"data": 'scores.' + value})
      }
   })
   console.log(columns)
   $(document).ready(function() {
    $('#resultTable').DataTable({
          processing: true,
          serverSide: true,
          paging: true,
          ajax: {
            url: dataUrl,
            type: "POST"
          },
          columns: columns,
          pageLength: 10,
          "dom": 'Bfrtip',
          "buttons": [
            'csv'
          ],
      })
  });
  // $('#resultTable').DataTable({
      //     columnDefs: [ {
      //         "searchable": false,
      //         "orderable": false,
      //         "targets": 0
      //     }],
      //     pageLength: 50,
      //     "dom": 'Bfrtip',
      //     "buttons": [
      //       'csv'
      //     ],
      //     order: [[indexLastColumn, "desc"]]
      // })
</script>
{% endblock %}