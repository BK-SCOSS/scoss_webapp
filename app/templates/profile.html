{% extends "base.html" %}

{% block title %}SCOSS - Profile{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Profile</h3>
            </div>
            <div class="card-body">
                <form action="/users/{{session['user_id']}}/update" method="POST" id="update_profile">
                    <div class="form-group row">
                        <label for="username" class="col-sm-2 control-label">Username</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" name="username" placeholder="Username" value="{{data['username']}}" disabled>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="email" class="col-sm-2 control-label">Email</label>
                        <div class="col-sm-10">
                            <input type="email" class="form-control" name="email" placeholder="Email"  value="{{data['email']}}" required>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="password" class="col-sm-2 control-label">Old Password</label>
                        <div class="col-sm-10">
                            <input type="password" class="form-control" name="old_password" placeholder="Old password" required>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="newpassword" class="col-sm-2 control-label">New Password</label>
                        <div class="col-sm-10">
                            <input type="password" class="form-control" name="new_password" placeholder="New password" required>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="confirm" class="col-sm-2 control-label">Confirm</label>
                        <div class="col-sm-10">
                            <input type="password" class="form-control" name="confirm" placeholder="Confirm" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">Save changes</button>
                </form>
            </div>
        </div>
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Public key</h3>
            </div>
            <div class="card-body">
                <div style="text-align: center;">
                    <button>Generate new public key</button>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block js %}
<script>
    $("input[name='confirm']").on('keyup', function () {
        if ($("input[name='new_password']").val() == $("input[name='confirm']").val()) {
            $("input[name='confirm']").removeClass('is-invalid');
            $("input[name='confirm']").addClass('is-valid');
        } else {
            $("input[name='confirm']").removeClass('is-valid');
            $("input[name='confirm']").addClass('is-invalid');
        }
    });
    
    $("#update_profile").submit(function(e){
        if ($("input[name='new_password']").val() != $("input[name='confirm']").val())
        {
            e.preventDefault(); // avoid to execute the actual submit of the form.
        }
    })
</script>
{% endblock %}
